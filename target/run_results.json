{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-19T02:56:53.153420Z", "invocation_id": "4802aa11-be51-48d3-a324-06f875db3edb", "invocation_started_at": "2026-01-19T02:56:43.069957Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.753545Z", "completed_at": "2026-01-19T02:56:52.769223Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.769733Z", "completed_at": "2026-01-19T02:56:52.769746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020860910415649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.stg_account_closed", "compiled": true, "compiled_code": "select\n  account_id_hashed as account_id,\n  closed_ts as closed_at\nfrom `analytics-take-home-test`.`monzo_datawarehouse`.`account_closed`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_closed`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.761482Z", "completed_at": "2026-01-19T02:56:52.771074Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.771724Z", "completed_at": "2026-01-19T02:56:52.771733Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02302408218383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.stg_account_created", "compiled": true, "compiled_code": "select\n  account_id_hashed as account_id,\n  user_id_hashed as user_id,\n  account_type,\n  created_ts as created_at\nfrom `analytics-take-home-test`.`monzo_datawarehouse`.`account_created`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.763801Z", "completed_at": "2026-01-19T02:56:52.772370Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.774287Z", "completed_at": "2026-01-19T02:56:52.774294Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02506399154663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.stg_account_transactions", "compiled": true, "compiled_code": "select\n  account_id_hashed as account_id,\n  date as activity_date,\n  transactions_num\nfrom `analytics-take-home-test`.`monzo_datawarehouse`.`account_transactions`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.766750Z", "completed_at": "2026-01-19T02:56:52.772953Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.774631Z", "completed_at": "2026-01-19T02:56:52.774640Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024815797805786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.stg_account_reopened", "compiled": true, "compiled_code": "select\n  account_id_hashed as account_id,\n  reopened_ts as reopened_at\nfrom `analytics-take-home-test`.`monzo_datawarehouse`.`account_reopened`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_reopened`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.777582Z", "completed_at": "2026-01-19T02:56:52.794124Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.801589Z", "completed_at": "2026-01-19T02:56:52.801601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028864622116088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_closed_account_id.91d38f35b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_closed`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.790204Z", "completed_at": "2026-01-19T02:56:52.802056Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.803346Z", "completed_at": "2026-01-19T02:56:52.803354Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02731919288635254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_closed_closed_at.d8e28fd78b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect closed_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_closed`\nwhere closed_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.797807Z", "completed_at": "2026-01-19T02:56:52.804991Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.806758Z", "completed_at": "2026-01-19T02:56:52.806768Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018583297729492188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_created_created_at.c7a662b774", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.794430Z", "completed_at": "2026-01-19T02:56:52.805266Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.807253Z", "completed_at": "2026-01-19T02:56:52.807258Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019868850708007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_created_account_id.d43a6777f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.809894Z", "completed_at": "2026-01-19T02:56:52.820976Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.827602Z", "completed_at": "2026-01-19T02:56:52.827610Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02427530288696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_created_user_id.58baaec411", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.814644Z", "completed_at": "2026-01-19T02:56:52.829040Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.831016Z", "completed_at": "2026-01-19T02:56:52.831028Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024557113647460938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.unique_stg_account_created_account_id.2a9248d747", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select account_id as unique_field\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\n  where account_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.821490Z", "completed_at": "2026-01-19T02:56:52.831942Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.833730Z", "completed_at": "2026-01-19T02:56:52.833739Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016201496124267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_transactions_account_id.4f1b89413d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.824724Z", "completed_at": "2026-01-19T02:56:52.832853Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.834606Z", "completed_at": "2026-01-19T02:56:52.834614Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01685500144958496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_transactions_activity_date.a3d03f5059", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_date\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\nwhere activity_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.837100Z", "completed_at": "2026-01-19T02:56:52.847060Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.854433Z", "completed_at": "2026-01-19T02:56:52.854446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022907733917236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_transactions_transactions_num.dfceb040f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transactions_num\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\nwhere transactions_num is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.842421Z", "completed_at": "2026-01-19T02:56:52.855300Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.857412Z", "completed_at": "2026-01-19T02:56:52.857421Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023090362548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.int_account_lifecycle_events", "compiled": true, "compiled_code": "with created as (\n\n  select\n    account_id,\n    user_id,\n    account_type,\n    created_at as event_at,\n    'created' as event_type\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\n\n),\n\nclosed as (\n\n  select\n    account_id,\n    cast(null as string) as user_id,\n    cast(null as string) as account_type,\n    closed_at as event_at,\n    'closed' as event_type\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_closed`\n\n),\n\nreopened as (\n\n  select\n    account_id,\n    cast(null as string) as user_id,\n    cast(null as string) as account_type,\n    reopened_at as event_at,\n    'reopened' as event_type\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_reopened`\n\n),\n\nunioned as (\n\n  select * from created\n  union all\n  select * from closed\n  union all\n  select * from reopened\n\n),\n\nordered as (\n\n  select\n    account_id,\n    user_id,\n    account_type,\n    event_type,\n    event_at,\n\n    row_number() over (\n      partition by account_id\n      order by event_at, event_type\n    ) as event_sequence\n\n  from unioned\n\n)\n\nselect\n  account_id,\n  user_id,\n  account_type,\n  event_type,\n  event_at,\n  event_sequence\nfrom ordered", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.847484Z", "completed_at": "2026-01-19T02:56:52.857025Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.858565Z", "completed_at": "2026-01-19T02:56:52.858572Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01819324493408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_reopened_account_id.808e8c2953", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_reopened`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.851253Z", "completed_at": "2026-01-19T02:56:52.858119Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.859608Z", "completed_at": "2026-01-19T02:56:52.859613Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016088485717773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_stg_account_reopened_reopened_at.2fecf860d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reopened_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_reopened`\nwhere reopened_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.866886Z", "completed_at": "2026-01-19T02:56:52.884579Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.885418Z", "completed_at": "2026-01-19T02:56:52.885431Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023630857467651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_lifecycle_events_account_id.9116794a5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.873094Z", "completed_at": "2026-01-19T02:56:52.884978Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.886566Z", "completed_at": "2026-01-19T02:56:52.886574Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024063587188720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_lifecycle_events_event_at.09e6b6f67a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\nwhere event_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.870278Z", "completed_at": "2026-01-19T02:56:52.885983Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.887767Z", "completed_at": "2026-01-19T02:56:52.887772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02573561668395996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.int_account_state_transitions", "compiled": true, "compiled_code": "with events as (\n\n  select\n    account_id,\n    user_id,\n    account_type,\n    event_type,\n    event_at,\n    event_sequence\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\n\n),\n\nstates as (\n\n  select\n    account_id,\n\n    -- user_id and account_type only exist on creation\n    first_value(user_id ignore nulls)\n      over (\n        partition by account_id\n        order by event_sequence\n      ) as user_id,\n\n    first_value(account_type ignore nulls)\n      over (\n        partition by account_id\n        order by event_sequence\n      ) as account_type,\n\n    \n  case\n    when event_type in ('created', 'reopened') then 'open'\n    when event_type = 'closed' then 'closed'\n  end\n as account_status,\n\n    event_at as valid_from,\n\n    lead(event_at) over (\n      partition by account_id\n      order by event_sequence\n    ) as valid_to\n\n  from events\n\n)\n\nselect\n  account_id,\n  user_id,\n  account_type,\n  account_status,\n  valid_from,\n  valid_to\nfrom states", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.875905Z", "completed_at": "2026-01-19T02:56:52.888089Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.890140Z", "completed_at": "2026-01-19T02:56:52.890146Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026921510696411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.accepted_values_int_account_lifecycle_events_event_type__created__closed__reopened.02df24e906", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'created','closed','reopened'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.900321Z", "completed_at": "2026-01-19T02:56:52.910205Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.910564Z", "completed_at": "2026-01-19T02:56:52.910572Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018790006637573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_lifecycle_events_event_type.a8355633a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\nwhere event_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.894408Z", "completed_at": "2026-01-19T02:56:52.912660Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.917040Z", "completed_at": "2026-01-19T02:56:52.917049Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026884078979492188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_lifecycle_events_event_sequence.dc5b2b3a3f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_sequence\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\nwhere event_sequence is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.903923Z", "completed_at": "2026-01-19T02:56:52.922581Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.924165Z", "completed_at": "2026-01-19T02:56:52.924176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0329899787902832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_lifecycle_events_user_id.9ef4ffb7e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom (select * from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events` where event_type = 'created') dbt_subquery\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.907761Z", "completed_at": "2026-01-19T02:56:52.923142Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.925090Z", "completed_at": "2026-01-19T02:56:52.925096Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02712702751159668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.dim_accounts_history", "compiled": true, "compiled_code": "select\n  account_id,\n  user_id,\n  account_type,\n  account_status,\n  valid_from,\n  valid_to,\n  account_status = 'open' as is_open,\n  valid_to is null as is_current\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.919229Z", "completed_at": "2026-01-19T02:56:52.923786Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.925471Z", "completed_at": "2026-01-19T02:56:52.925477Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009276390075683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_state_transitions_account_id.8f5e0b1883", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.913198Z", "completed_at": "2026-01-19T02:56:52.924660Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.926475Z", "completed_at": "2026-01-19T02:56:52.926481Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017235279083251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.accepted_values_int_account_state_transitions_account_status__open__closed.f916511dd0", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'open','closed'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.933466Z", "completed_at": "2026-01-19T02:56:52.945785Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.946299Z", "completed_at": "2026-01-19T02:56:52.946316Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0161588191986084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_state_transitions_account_status.d585e819b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\nwhere account_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.940117Z", "completed_at": "2026-01-19T02:56:52.951053Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.952574Z", "completed_at": "2026-01-19T02:56:52.952584Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022986412048339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_state_transitions_valid_from.de3648424b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_from\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\nwhere valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.936869Z", "completed_at": "2026-01-19T02:56:52.951593Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.953154Z", "completed_at": "2026-01-19T02:56:52.953164Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023968219757080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_account_state_transitions_user_id.457c6d4969", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.943020Z", "completed_at": "2026-01-19T02:56:52.952099Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.954059Z", "completed_at": "2026-01-19T02:56:52.954069Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02426886558532715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.dim_accounts", "compiled": true, "compiled_code": "select\n  account_id,\n  user_id,\n  account_type,\n  account_status,\n  is_open,\n  valid_from as status_updated_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere is_current = true", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.948536Z", "completed_at": "2026-01-19T02:56:52.953669Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.956085Z", "completed_at": "2026-01-19T02:56:52.956094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010673046112060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.int_user_open_status_daily", "compiled": true, "compiled_code": "with account_states as (\n\n  select\n    account_id,\n    user_id,\n    date(valid_from) as valid_from_date,\n    date(coalesce(valid_to, timestamp '9999-12-31')) as valid_to_date\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\n  where is_open = true\n\n),\n\ndates as (\n\n  select distinct activity_date\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\n\n),\n\nuser_open_by_day as (\n\n  select distinct\n    a.user_id,\n    d.activity_date\n  from account_states as a\n  inner join dates as d\n    on\n      a.valid_from_date <= d.activity_date\n      and a.valid_to_date > d.activity_date\n\n)\n\nselect\n  user_id,\n  activity_date,\n  true as has_open_account\nfrom user_open_by_day", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.966345Z", "completed_at": "2026-01-19T02:56:52.974436Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.974771Z", "completed_at": "2026-01-19T02:56:52.974778Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01601576805114746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.account_must_start_open", "compiled": true, "compiled_code": "-- Meaning: Every account must start life as open.\n\nselect\n  account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\ngroup by account_id\nhaving min(valid_from) != min(case when account_status = 'open' then valid_from end)", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.962609Z", "completed_at": "2026-01-19T02:56:52.975050Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.976555Z", "completed_at": "2026-01-19T02:56:52.976564Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018712282180786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.accepted_values_dim_accounts_history_account_status__open__closed.c49cfa0ee9", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'open','closed'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.969573Z", "completed_at": "2026-01-19T02:56:52.976862Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.978705Z", "completed_at": "2026-01-19T02:56:52.978715Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019906282424926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.current_state_validity_consistency", "compiled": true, "compiled_code": "-- valid_to is null iff is_current = true\n\nselect *\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere\n  (is_current and valid_to is not null)\n  or\n  (not is_current and valid_to is null)", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.972022Z", "completed_at": "2026-01-19T02:56:52.979223Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.981236Z", "completed_at": "2026-01-19T02:56:52.981242Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021117687225341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.no_overlapping_account_states", "compiled": true, "compiled_code": "-- Expected result: 0 rows.\n-- What this proves: SCD logic is sound.\n\nselect\n  account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nqualify\n  count(*) over (\n    partition by account_id\n    order by valid_from\n    rows between current row and 1 following\n  ) > 1\n  and valid_to > lead(valid_from) over (\n    partition by account_id\n    order by valid_from\n  )", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.983303Z", "completed_at": "2026-01-19T02:56:52.993104Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:52.995819Z", "completed_at": "2026-01-19T02:56:52.995833Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020263671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_dim_accounts_history_account_id.6faa021e5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.988505Z", "completed_at": "2026-01-19T02:56:52.996389Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.000417Z", "completed_at": "2026-01-19T02:56:53.000423Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0197446346282959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_dim_accounts_history_valid_from.7ed82e0b95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_from\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.993391Z", "completed_at": "2026-01-19T02:56:53.001205Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.002959Z", "completed_at": "2026-01-19T02:56:53.002966Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017388582229614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.single_current_state_per_account", "compiled": true, "compiled_code": "-- Exactly one current row per account\n\nselect\n  account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere is_current\ngroup by account_id\nhaving count(*) != 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:52.996940Z", "completed_at": "2026-01-19T02:56:53.002262Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.003703Z", "completed_at": "2026-01-19T02:56:53.003708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013224124908447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.int_user_daily_activity", "compiled": true, "compiled_code": "with transactions as (\n\n  select\n    account_id,\n    activity_date,\n    transactions_num\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\n\n),\n\naccounts as (\n\n  select\n    account_id,\n    user_id\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\n),\n\nuser_activity as (\n\n  select\n    a.user_id,\n    t.activity_date,\n    sum(t.transactions_num) as transactions_num\n  from transactions as t\n  inner join accounts as a\n    on t.account_id = a.account_id\n  group by 1, 2\n\n)\n\nselect\n  user_id,\n  activity_date,\n  transactions_num,\n  transactions_num > 0 as is_active\nfrom user_activity", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.006284Z", "completed_at": "2026-01-19T02:56:53.016014Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.022714Z", "completed_at": "2026-01-19T02:56:53.022723Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021546363830566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.accepted_values_dim_accounts_account_status__open__closed.25bcc86c18", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'open','closed'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.011389Z", "completed_at": "2026-01-19T02:56:53.023386Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.024733Z", "completed_at": "2026-01-19T02:56:53.024743Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02146601676940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.dim_accounts_matches_history", "compiled": true, "compiled_code": "-- dim_accounts matches history\u2019s current state\n\nselect\n  d.account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts` d\njoin `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history` h\n  on d.account_id = h.account_id\nwhere h.is_current\n  and d.account_status != h.account_status", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.016569Z", "completed_at": "2026-01-19T02:56:53.025186Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.027147Z", "completed_at": "2026-01-19T02:56:53.027153Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018146276473999023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_dim_accounts_account_id.cc26245841", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.019613Z", "completed_at": "2026-01-19T02:56:53.025573Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.027488Z", "completed_at": "2026-01-19T02:56:53.027492Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015166997909545898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_dim_accounts_account_status.a6be6b7da0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere account_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.031740Z", "completed_at": "2026-01-19T02:56:53.046565Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.047123Z", "completed_at": "2026-01-19T02:56:53.047132Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019917011260986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_dim_accounts_is_open.aafc57baad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_open\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere is_open is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.035898Z", "completed_at": "2026-01-19T02:56:53.048150Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.048847Z", "completed_at": "2026-01-19T02:56:53.048854Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021428346633911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_dim_accounts_status_updated_at.dc70f18e38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_updated_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere status_updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.039859Z", "completed_at": "2026-01-19T02:56:53.052942Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.057363Z", "completed_at": "2026-01-19T02:56:53.057370Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023960113525390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_dim_accounts_user_id.72064b4908", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.043495Z", "completed_at": "2026-01-19T02:56:53.053920Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.058233Z", "completed_at": "2026-01-19T02:56:53.058243Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024698495864868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.unique_dim_accounts_account_id.bfd6344edc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select account_id as unique_field\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\n  where account_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.054274Z", "completed_at": "2026-01-19T02:56:53.061087Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.066733Z", "completed_at": "2026-01-19T02:56:53.066742Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019009113311767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_user_open_status_daily_activity_date.097c9c7972", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_date\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\nwhere activity_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.061467Z", "completed_at": "2026-01-19T02:56:53.072546Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.076167Z", "completed_at": "2026-01-19T02:56:53.076178Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01993703842163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_user_open_status_daily_has_open_account.bd5be411ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect has_open_account\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\nwhere has_open_account is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.069166Z", "completed_at": "2026-01-19T02:56:53.076735Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.078804Z", "completed_at": "2026-01-19T02:56:53.078811Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017863035202026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_user_open_status_daily_user_id.740c43c473", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.073111Z", "completed_at": "2026-01-19T02:56:53.083457Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.085490Z", "completed_at": "2026-01-19T02:56:53.085500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0202786922454834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ae_stanley_igwe_monzo.fct_7d_active_users_daily", "compiled": true, "compiled_code": "with calendar as (\n\n  select distinct activity_date\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\n\n),\n\neligible_users as (\n\n  select\n    activity_date,\n    count(distinct user_id) as eligible_users\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\n  group by activity_date\n\n),\n\ndistinct_users as (\n\n  select distinct user_id\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\n\n),\n\nuser_activity_spine as (\n\n  select\n    c.activity_date,\n    u.user_id,\n    coalesce(a.is_active, false) as is_active\n  from calendar as c\n  inner join distinct_users as u\n    on true\n  left join `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity` as a\n    on\n      u.user_id = a.user_id\n      and c.activity_date = a.activity_date\n\n),\n\nrolling_activity as (\n\n  select\n    activity_date,\n    user_id,\n\n    max(cast(is_active as int64)) over (\n      partition by user_id\n      order by activity_date\n      rows between 6 preceding and current row\n    ) as is_active_7d\n\n  from user_activity_spine\n\n),\n\nactive_users as (\n\n  select\n    activity_date,\n    count(distinct user_id) as active_users\n  from rolling_activity\n  where is_active_7d = 1\n  group by activity_date\n\n)\n\nselect\n  c.activity_date,\n  e.eligible_users,\n  a.active_users,\n  safe_divide(a.active_users, e.eligible_users) as active_rate_7d\nfrom calendar as c\nleft join eligible_users as e\n  on c.activity_date = e.activity_date\nleft join active_users as a\n  on c.activity_date = a.activity_date\norder by c.activity_date", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.079166Z", "completed_at": "2026-01-19T02:56:53.086898Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.091198Z", "completed_at": "2026-01-19T02:56:53.091205Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016944169998168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_user_daily_activity_activity_date.506b9497c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_date\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`\nwhere activity_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.088253Z", "completed_at": "2026-01-19T02:56:53.097713Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.099256Z", "completed_at": "2026-01-19T02:56:53.099269Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018662691116333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_user_daily_activity_is_active.a17fda12f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_active\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`\nwhere is_active is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.093548Z", "completed_at": "2026-01-19T02:56:53.103011Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.107485Z", "completed_at": "2026-01-19T02:56:53.107492Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021040916442871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_user_daily_activity_transactions_num.b8732fb1a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transactions_num\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`\nwhere transactions_num is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.099668Z", "completed_at": "2026-01-19T02:56:53.108330Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.110520Z", "completed_at": "2026-01-19T02:56:53.110529Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01899433135986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_int_user_daily_activity_user_id.6e2ba3d6d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.104577Z", "completed_at": "2026-01-19T02:56:53.110861Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.112680Z", "completed_at": "2026-01-19T02:56:53.112690Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0176541805267334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.active_rate_bounds", "compiled": true, "compiled_code": "-- active_rate_7d is between 0 and 1\n\nselect *\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere active_rate_7d < 0\n   or active_rate_7d > 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.113665Z", "completed_at": "2026-01-19T02:56:53.122606Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.126863Z", "completed_at": "2026-01-19T02:56:53.126874Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022083520889282227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.active_users_not_greater_than_eligible", "compiled": true, "compiled_code": "-- active_users \u2264 eligible_users\n\nselect *\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere active_users > eligible_users", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.118565Z", "completed_at": "2026-01-19T02:56:53.131154Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.132907Z", "completed_at": "2026-01-19T02:56:53.132916Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02077007293701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_fct_7d_active_users_daily_active_rate_7d.c9ca6e94d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_rate_7d\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere active_rate_7d is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.123237Z", "completed_at": "2026-01-19T02:56:53.134958Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.136718Z", "completed_at": "2026-01-19T02:56:53.136726Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023674488067626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_fct_7d_active_users_daily_active_users.494e26f377", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_users\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere active_users is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.127279Z", "completed_at": "2026-01-19T02:56:53.135648Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.137683Z", "completed_at": "2026-01-19T02:56:53.137688Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020157337188720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_fct_7d_active_users_daily_activity_date.b8164ee4f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_date\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere activity_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.138071Z", "completed_at": "2026-01-19T02:56:53.147518Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.147889Z", "completed_at": "2026-01-19T02:56:53.147896Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013782501220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.not_null_fct_7d_active_users_daily_eligible_users.1188a73afe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect eligible_users\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere eligible_users is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T02:56:53.143154Z", "completed_at": "2026-01-19T02:56:53.149137Z"}, {"name": "execute", "started_at": "2026-01-19T02:56:53.149452Z", "completed_at": "2026-01-19T02:56:53.149457Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012714385986328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ae_stanley_igwe_monzo.unique_fct_7d_active_users_daily_activity_date.09d0dde558", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_date as unique_field\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\n  where activity_date is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.7391111850738525, "args": {"log_level": "info", "upload_to_artifacts_ingest_api": false, "defer": false, "require_nested_cumulative_type_params": false, "use_colors_file": true, "send_anonymous_usage_stats": true, "empty_catalog": false, "print": true, "use_fast_test_edges": false, "favor_state": false, "require_batched_execution_for_custom_microbatch_strategy": false, "log_path": "C:\\Users\\azigw\\Documents\\GitHub\\ae_stanley_igwe _monzo\\logs", "which": "generate", "cache_selected_only": false, "partial_parse": true, "skip_nodes_if_on_run_start_fails": false, "invocation_command": "dbt docs generate", "log_level_file": "debug", "log_format": "default", "partial_parse_file_diff": true, "require_resource_names_without_spaces": true, "require_generic_test_arguments_property": true, "static_parser": true, "project_dir": "C:\\Users\\azigw\\Documents\\GitHub\\ae_stanley_igwe _monzo", "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": true, "introspect": true, "log_format_file": "debug", "show_all_deprecations": false, "strict_mode": false, "require_all_warnings_handled_by_warn_error": false, "compile": true, "require_unique_project_resource_names": false, "quiet": false, "show_resource_report": false, "exclude": [], "populate_cache": true, "vars": {}, "state_modified_compare_vars": false, "select": [], "static": false, "version_check": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "write_json": true, "validate_macro_args": false, "printer_width": 80, "macro_debugging": false, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "indirect_selection": "eager", "require_ref_searches_node_package_before_root": false, "profiles_dir": "C:\\Users\\azigw\\.dbt", "log_file_max_bytes": 10485760}}