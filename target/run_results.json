{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-18T13:56:06.246562Z", "invocation_id": "efed9589-04d8-47c4-9df6-0cef506504d2", "invocation_started_at": "2026-01-18T13:55:51.547227Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.654809Z", "completed_at": "2026-01-18T13:56:05.675140Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.675942Z", "completed_at": "2026-01-18T13:56:05.675959Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026511669158935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.stg_account_created", "compiled": true, "compiled_code": "select\n  account_id_hashed as account_id,\n  user_id_hashed as user_id,\n  account_type,\n  created_ts as created_at\nfrom `analytics-take-home-test`.`monzo_datawarehouse`.`account_created`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.672429Z", "completed_at": "2026-01-18T13:56:05.678068Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.680022Z", "completed_at": "2026-01-18T13:56:05.680036Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0285642147064209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.stg_account_transactions", "compiled": true, "compiled_code": "select\n  account_id_hashed as account_id,\n  date as activity_date,\n  transactions_num\nfrom `analytics-take-home-test`.`monzo_datawarehouse`.`account_transactions`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.668111Z", "completed_at": "2026-01-18T13:56:05.678860Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.681141Z", "completed_at": "2026-01-18T13:56:05.681151Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030550479888916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.stg_account_closed", "compiled": true, "compiled_code": "select\n  account_id_hashed as account_id,\n  closed_ts as closed_at\nfrom `analytics-take-home-test`.`monzo_datawarehouse`.`account_closed`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_closed`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.665061Z", "completed_at": "2026-01-18T13:56:05.679296Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.681653Z", "completed_at": "2026-01-18T13:56:05.681665Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03192853927612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.stg_account_reopened", "compiled": true, "compiled_code": "select\n  account_id_hashed as account_id,\n  reopened_ts as reopened_at\nfrom `analytics-take-home-test`.`monzo_datawarehouse`.`account_reopened`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_reopened`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.689106Z", "completed_at": "2026-01-18T13:56:05.721972Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.723109Z", "completed_at": "2026-01-18T13:56:05.723128Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04063248634338379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_created_account_id.d43a6777f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.706231Z", "completed_at": "2026-01-18T13:56:05.725673Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.726699Z", "completed_at": "2026-01-18T13:56:05.726710Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04432868957519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_created_created_at.c7a662b774", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.710387Z", "completed_at": "2026-01-18T13:56:05.727125Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.733451Z", "completed_at": "2026-01-18T13:56:05.733461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03244304656982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_created_user_id.58baaec411", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.714714Z", "completed_at": "2026-01-18T13:56:05.727561Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.734021Z", "completed_at": "2026-01-18T13:56:05.734028Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03277993202209473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.unique_stg_account_created_account_id.2a9248d747", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select account_id as unique_field\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\n  where account_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.727911Z", "completed_at": "2026-01-18T13:56:05.739085Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.741097Z", "completed_at": "2026-01-18T13:56:05.741109Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022502422332763672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_transactions_account_id.4f1b89413d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.741530Z", "completed_at": "2026-01-18T13:56:05.758528Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.759917Z", "completed_at": "2026-01-18T13:56:05.759930Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024698257446289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_transactions_activity_date.a3d03f5059", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_date\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\nwhere activity_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.753416Z", "completed_at": "2026-01-18T13:56:05.762476Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.768637Z", "completed_at": "2026-01-18T13:56:05.768649Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030443429946899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_closed_account_id.91d38f35b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_closed`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.748528Z", "completed_at": "2026-01-18T13:56:05.767222Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.769334Z", "completed_at": "2026-01-18T13:56:05.769344Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03216242790222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_transactions_transactions_num.dfceb040f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transactions_num\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\nwhere transactions_num is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.762940Z", "completed_at": "2026-01-18T13:56:05.773751Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.779388Z", "completed_at": "2026-01-18T13:56:05.779403Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022457122802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_closed_closed_at.d8e28fd78b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect closed_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_closed`\nwhere closed_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.775367Z", "completed_at": "2026-01-18T13:56:05.783871Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.794849Z", "completed_at": "2026-01-18T13:56:05.794861Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02618718147277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.int_account_lifecycle_events", "compiled": true, "compiled_code": "with created as (\n\n  select\n    account_id,\n    user_id,\n    account_type,\n    created_at as event_at,\n    'created' as event_type\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_created`\n\n),\n\nclosed as (\n\n  select\n    account_id,\n    cast(null as string) as user_id,\n    cast(null as string) as account_type,\n    closed_at as event_at,\n    'closed' as event_type\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_closed`\n\n),\n\nreopened as (\n\n  select\n    account_id,\n    cast(null as string) as user_id,\n    cast(null as string) as account_type,\n    reopened_at as event_at,\n    'reopened' as event_type\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_reopened`\n\n),\n\nunioned as (\n\n  select * from created\n  union all\n  select * from closed\n  union all\n  select * from reopened\n\n),\n\nordered as (\n\n  select\n    account_id,\n    user_id,\n    account_type,\n    event_type,\n    event_at,\n\n    row_number() over (\n      partition by account_id\n      order by event_at, event_type\n    ) as event_sequence\n\n  from unioned\n\n)\n\nselect\n  account_id,\n  user_id,\n  account_type,\n  event_type,\n  event_at,\n  event_sequence\nfrom ordered", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.784678Z", "completed_at": "2026-01-18T13:56:05.799528Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.801408Z", "completed_at": "2026-01-18T13:56:05.801418Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029089689254760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_reopened_account_id.808e8c2953", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_reopened`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.789891Z", "completed_at": "2026-01-18T13:56:05.799965Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.801871Z", "completed_at": "2026-01-18T13:56:05.801882Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029963970184326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_stg_account_reopened_reopened_at.2fecf860d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reopened_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_reopened`\nwhere reopened_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.803370Z", "completed_at": "2026-01-18T13:56:05.826216Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.835687Z", "completed_at": "2026-01-18T13:56:05.835698Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04384589195251465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.int_account_state_transitions", "compiled": true, "compiled_code": "with events as (\n\n  select\n    account_id,\n    user_id,\n    account_type,\n    event_type,\n    event_at,\n    event_sequence\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\n\n),\n\nstates as (\n\n  select\n    account_id,\n\n    -- user_id and account_type only exist on creation\n    first_value(user_id ignore nulls)\n      over (\n        partition by account_id\n        order by event_sequence\n      ) as user_id,\n\n    first_value(account_type ignore nulls)\n      over (\n        partition by account_id\n        order by event_sequence\n      ) as account_type,\n\n    \n  case\n    when event_type in ('created', 'reopened') then 'open'\n    when event_type = 'closed' then 'closed'\n  end\n as account_status,\n\n    event_at as valid_from,\n\n    lead(event_at) over (\n      partition by account_id\n      order by event_sequence\n    ) as valid_to\n\n  from events\n\n)\n\nselect\n  account_id,\n  user_id,\n  account_type,\n  account_status,\n  valid_from,\n  valid_to\nfrom states", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.811161Z", "completed_at": "2026-01-18T13:56:05.827336Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.841667Z", "completed_at": "2026-01-18T13:56:05.841684Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04351019859313965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.accepted_values_int_account_lifecycle_events_event_type__created__closed__reopened.02df24e906", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'created','closed','reopened'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.827877Z", "completed_at": "2026-01-18T13:56:05.846467Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.849121Z", "completed_at": "2026-01-18T13:56:05.849134Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027049779891967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_lifecycle_events_account_id.9116794a5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.836689Z", "completed_at": "2026-01-18T13:56:05.847983Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.850081Z", "completed_at": "2026-01-18T13:56:05.850089Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03327345848083496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_lifecycle_events_event_at.09e6b6f67a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\nwhere event_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.852335Z", "completed_at": "2026-01-18T13:56:05.866173Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.867851Z", "completed_at": "2026-01-18T13:56:05.867865Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028235435485839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_lifecycle_events_event_sequence.dc5b2b3a3f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_sequence\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\nwhere event_sequence is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.859614Z", "completed_at": "2026-01-18T13:56:05.868403Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.876117Z", "completed_at": "2026-01-18T13:56:05.876125Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.031884193420410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_lifecycle_events_event_type.a8355633a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events`\nwhere event_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.870095Z", "completed_at": "2026-01-18T13:56:05.882453Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.884860Z", "completed_at": "2026-01-18T13:56:05.884869Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027922868728637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_lifecycle_events_user_id.9ef4ffb7e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom (select * from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_lifecycle_events` where event_type = 'created') dbt_subquery\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.876552Z", "completed_at": "2026-01-18T13:56:05.884210Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.892608Z", "completed_at": "2026-01-18T13:56:05.892620Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03221011161804199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.dim_accounts_history", "compiled": true, "compiled_code": "select\n  account_id,\n  user_id,\n  account_type,\n  account_status,\n  valid_from,\n  valid_to,\n  account_status = 'open' as is_open,\n  valid_to is null as is_current\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.885522Z", "completed_at": "2026-01-18T13:56:05.900701Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.902767Z", "completed_at": "2026-01-18T13:56:05.902778Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024590015411376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.accepted_values_int_account_state_transitions_account_status__open__closed.f916511dd0", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'open','closed'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.894377Z", "completed_at": "2026-01-18T13:56:05.904633Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.907119Z", "completed_at": "2026-01-18T13:56:05.907129Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03394937515258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_state_transitions_account_id.8f5e0b1883", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.907601Z", "completed_at": "2026-01-18T13:56:05.921778Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.929447Z", "completed_at": "2026-01-18T13:56:05.929461Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03350114822387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_state_transitions_account_status.d585e819b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\nwhere account_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.913164Z", "completed_at": "2026-01-18T13:56:05.928059Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.930223Z", "completed_at": "2026-01-18T13:56:05.930234Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03304719924926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_state_transitions_user_id.457c6d4969", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.922410Z", "completed_at": "2026-01-18T13:56:05.930931Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.937752Z", "completed_at": "2026-01-18T13:56:05.937771Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021891355514526367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_account_state_transitions_valid_from.de3648424b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_from\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_account_state_transitions`\nwhere valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.931514Z", "completed_at": "2026-01-18T13:56:05.941862Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.944138Z", "completed_at": "2026-01-18T13:56:05.944147Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028531312942504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.dim_accounts", "compiled": true, "compiled_code": "select\n  account_id,\n  user_id,\n  account_type,\n  account_status,\n  is_open,\n  valid_from as status_updated_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere is_current = true", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.945666Z", "completed_at": "2026-01-18T13:56:05.962660Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.967417Z", "completed_at": "2026-01-18T13:56:05.967437Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0289156436920166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.int_user_open_status_daily", "compiled": true, "compiled_code": "with account_states as (\n\n  select\n    account_id,\n    user_id,\n    date(valid_from) as valid_from_date,\n    date(coalesce(valid_to, timestamp '9999-12-31')) as valid_to_date\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\n  where is_open = true\n\n),\n\ndates as (\n\n  select distinct activity_date\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\n\n),\n\nuser_open_by_day as (\n\n  select distinct\n    a.user_id,\n    d.activity_date\n  from account_states as a\n  inner join dates as d\n    on\n      a.valid_from_date <= d.activity_date\n      and a.valid_to_date > d.activity_date\n\n)\n\nselect\n  user_id,\n  activity_date,\n  true as has_open_account\nfrom user_open_by_day", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.950326Z", "completed_at": "2026-01-18T13:56:05.968441Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.970861Z", "completed_at": "2026-01-18T13:56:05.970872Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03095698356628418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.accepted_values_dim_accounts_history_account_status__open__closed.c49cfa0ee9", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'open','closed'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.957638Z", "completed_at": "2026-01-18T13:56:05.968972Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.971635Z", "completed_at": "2026-01-18T13:56:05.971647Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029310941696166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.account_must_start_open", "compiled": true, "compiled_code": "-- Meaning: Every account must start life as open.\n\nselect\n  account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\ngroup by account_id\nhaving min(valid_from) != min(case when account_status = 'open' then valid_from end)", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.963383Z", "completed_at": "2026-01-18T13:56:05.975203Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:05.977707Z", "completed_at": "2026-01-18T13:56:05.977715Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019410133361816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.current_state_validity_consistency", "compiled": true, "compiled_code": "-- valid_to is null iff is_current = true\n\nselect *\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere\n  (is_current and valid_to is not null)\n  or\n  (not is_current and valid_to is null)", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.985795Z", "completed_at": "2026-01-18T13:56:06.002218Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.004307Z", "completed_at": "2026-01-18T13:56:06.004327Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029068470001220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_dim_accounts_history_account_id.6faa021e5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.991571Z", "completed_at": "2026-01-18T13:56:06.002962Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.005241Z", "completed_at": "2026-01-18T13:56:06.005256Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029493093490600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_dim_accounts_history_valid_from.7ed82e0b95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_from\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.981001Z", "completed_at": "2026-01-18T13:56:06.003649Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.006440Z", "completed_at": "2026-01-18T13:56:06.006449Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03499865531921387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.no_overlapping_account_states", "compiled": true, "compiled_code": "-- Expected result: 0 rows.\n-- What this proves: SCD logic is sound.\n\nselect\n  account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nqualify\n  count(*) over (\n    partition by account_id\n    order by valid_from\n    rows between current row and 1 following\n  ) > 1\n  and valid_to > lead(valid_from) over (\n    partition by account_id\n    order by valid_from\n  )", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:05.998598Z", "completed_at": "2026-01-18T13:56:06.005967Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.009810Z", "completed_at": "2026-01-18T13:56:06.009823Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016643285751342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.single_current_state_per_account", "compiled": true, "compiled_code": "-- Exactly one current row per account\n\nselect\n  account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history`\nwhere is_current\ngroup by account_id\nhaving count(*) != 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.018444Z", "completed_at": "2026-01-18T13:56:06.037033Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.039243Z", "completed_at": "2026-01-18T13:56:06.039255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027753114700317383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.int_user_daily_activity", "compiled": true, "compiled_code": "with transactions as (\n\n  select\n    account_id,\n    activity_date,\n    transactions_num\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\n\n),\n\naccounts as (\n\n  select\n    account_id,\n    user_id\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\n),\n\nuser_activity as (\n\n  select\n    a.user_id,\n    t.activity_date,\n    sum(t.transactions_num) as transactions_num\n  from transactions as t\n  inner join accounts as a\n    on t.account_id = a.account_id\n  group by 1, 2\n\n)\n\nselect\n  user_id,\n  activity_date,\n  transactions_num,\n  transactions_num > 0 as is_active\nfrom user_activity", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.028416Z", "completed_at": "2026-01-18T13:56:06.037968Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.040063Z", "completed_at": "2026-01-18T13:56:06.040080Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027158021926879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.dim_accounts_matches_history", "compiled": true, "compiled_code": "-- dim_accounts matches history\u2019s current state\n\nselect\n  d.account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts` d\njoin `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts_history` h\n  on d.account_id = h.account_id\nwhere h.is_current\n  and d.account_status != h.account_status", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.022749Z", "completed_at": "2026-01-18T13:56:06.038576Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.041083Z", "completed_at": "2026-01-18T13:56:06.041096Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029747962951660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.accepted_values_dim_accounts_account_status__open__closed.25bcc86c18", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'open','closed'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.031855Z", "completed_at": "2026-01-18T13:56:06.040588Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.043958Z", "completed_at": "2026-01-18T13:56:06.043968Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029605388641357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_dim_accounts_account_id.cc26245841", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.058677Z", "completed_at": "2026-01-18T13:56:06.076093Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.077425Z", "completed_at": "2026-01-18T13:56:06.077439Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029400110244750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_dim_accounts_is_open.aafc57baad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_open\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere is_open is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.053954Z", "completed_at": "2026-01-18T13:56:06.076749Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.078202Z", "completed_at": "2026-01-18T13:56:06.078214Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03357839584350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_dim_accounts_account_status.a6be6b7da0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere account_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.070498Z", "completed_at": "2026-01-18T13:56:06.080697Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.083706Z", "completed_at": "2026-01-18T13:56:06.083716Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03362584114074707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_dim_accounts_user_id.72064b4908", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.063432Z", "completed_at": "2026-01-18T13:56:06.081411Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.084260Z", "completed_at": "2026-01-18T13:56:06.084270Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036322832107543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_dim_accounts_status_updated_at.dc70f18e38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_updated_at\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\nwhere status_updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.091903Z", "completed_at": "2026-01-18T13:56:06.104281Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.114895Z", "completed_at": "2026-01-18T13:56:06.114909Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03149294853210449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.unique_dim_accounts_account_id.bfd6344edc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select account_id as unique_field\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`dim_accounts`\n  where account_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.098173Z", "completed_at": "2026-01-18T13:56:06.115577Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.117739Z", "completed_at": "2026-01-18T13:56:06.117752Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03226470947265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_user_open_status_daily_activity_date.097c9c7972", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_date\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\nwhere activity_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.110187Z", "completed_at": "2026-01-18T13:56:06.119299Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.123211Z", "completed_at": "2026-01-18T13:56:06.123223Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028158187866210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_user_open_status_daily_user_id.740c43c473", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.105000Z", "completed_at": "2026-01-18T13:56:06.122073Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.124506Z", "completed_at": "2026-01-18T13:56:06.124515Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030327558517456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_user_open_status_daily_has_open_account.bd5be411ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect has_open_account\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\nwhere has_open_account is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.127993Z", "completed_at": "2026-01-18T13:56:06.141949Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.148736Z", "completed_at": "2026-01-18T13:56:06.148747Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03299856185913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.stanley_igwe_ae_monzo.fct_7d_active_users_daily", "compiled": true, "compiled_code": "with calendar as (\n\n  select distinct activity_date\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`stg_account_transactions`\n\n),\n\neligible_users as (\n\n  select\n    activity_date,\n    count(distinct user_id) as eligible_users\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\n  group by activity_date\n\n),\n\ndistinct_users as (\n\n  select distinct user_id\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_open_status_daily`\n\n),\n\nuser_activity_spine as (\n\n  select\n    c.activity_date,\n    u.user_id,\n    coalesce(a.is_active, false) as is_active\n  from calendar as c\n  inner join distinct_users as u\n    on true\n  left join `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity` as a\n    on\n      u.user_id = a.user_id\n      and c.activity_date = a.activity_date\n\n),\n\nrolling_activity as (\n\n  select\n    activity_date,\n    user_id,\n\n    max(cast(is_active as int64)) over (\n      partition by user_id\n      order by activity_date\n      rows between 6 preceding and current row\n    ) as is_active_7d\n\n  from user_activity_spine\n\n),\n\nactive_users as (\n\n  select\n    activity_date,\n    count(distinct user_id) as active_users\n  from rolling_activity\n  where is_active_7d = 1\n  group by activity_date\n\n)\n\nselect\n  c.activity_date,\n  e.eligible_users,\n  a.active_users,\n  safe_divide(a.active_users, e.eligible_users) as active_rate_7d\nfrom calendar as c\nleft join eligible_users as e\n  on c.activity_date = e.activity_date\nleft join active_users as a\n  on c.activity_date = a.activity_date\norder by c.activity_date", "relation_name": "`analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.135053Z", "completed_at": "2026-01-18T13:56:06.157238Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.160102Z", "completed_at": "2026-01-18T13:56:06.160120Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03632998466491699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_user_daily_activity_activity_date.506b9497c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_date\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`\nwhere activity_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.143695Z", "completed_at": "2026-01-18T13:56:06.158430Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.161532Z", "completed_at": "2026-01-18T13:56:06.161541Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029863357543945312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_user_daily_activity_is_active.a17fda12f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_active\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`\nwhere is_active is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.149346Z", "completed_at": "2026-01-18T13:56:06.159441Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.161988Z", "completed_at": "2026-01-18T13:56:06.161998Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02509593963623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_user_daily_activity_transactions_num.b8732fb1a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transactions_num\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`\nwhere transactions_num is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.166697Z", "completed_at": "2026-01-18T13:56:06.178173Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.186135Z", "completed_at": "2026-01-18T13:56:06.186163Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.034972429275512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_int_user_daily_activity_user_id.6e2ba3d6d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`int_user_daily_activity`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.179273Z", "completed_at": "2026-01-18T13:56:06.198637Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.201267Z", "completed_at": "2026-01-18T13:56:06.201279Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033383846282958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.active_rate_bounds", "compiled": true, "compiled_code": "-- active_rate_7d is between 0 and 1\n\nselect *\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere active_rate_7d < 0\n   or active_rate_7d > 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.187338Z", "completed_at": "2026-01-18T13:56:06.200146Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.206786Z", "completed_at": "2026-01-18T13:56:06.206798Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03299760818481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_fct_7d_active_users_daily_active_rate_7d.c9ca6e94d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_rate_7d\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere active_rate_7d is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.182644Z", "completed_at": "2026-01-18T13:56:06.199988Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.207350Z", "completed_at": "2026-01-18T13:56:06.207358Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0346827507019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.active_users_not_greater_than_eligible", "compiled": true, "compiled_code": "-- active_users \u2264 eligible_users\n\nselect *\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere active_users > eligible_users", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.201936Z", "completed_at": "2026-01-18T13:56:06.212056Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.214158Z", "completed_at": "2026-01-18T13:56:06.214167Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019871234893798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_fct_7d_active_users_daily_active_users.494e26f377", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_users\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere active_users is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.219338Z", "completed_at": "2026-01-18T13:56:06.234057Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.234594Z", "completed_at": "2026-01-18T13:56:06.234604Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022454500198364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_fct_7d_active_users_daily_activity_date.b8164ee4f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_date\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere activity_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.223887Z", "completed_at": "2026-01-18T13:56:06.236787Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.238909Z", "completed_at": "2026-01-18T13:56:06.238931Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02686166763305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.not_null_fct_7d_active_users_daily_eligible_users.1188a73afe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect eligible_users\nfrom `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\nwhere eligible_users is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T13:56:06.228413Z", "completed_at": "2026-01-18T13:56:06.237842Z"}, {"name": "execute", "started_at": "2026-01-18T13:56:06.239751Z", "completed_at": "2026-01-18T13:56:06.239760Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027004718780517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.stanley_igwe_ae_monzo.unique_fct_7d_active_users_daily_activity_date.09d0dde558", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_date as unique_field\n  from `analytics-take-home-test`.`AE_Stan_Igwe_Task_azigw`.`fct_7d_active_users_daily`\n  where activity_date is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 3.926283597946167, "args": {"require_unique_project_resource_names": false, "cache_selected_only": false, "invocation_command": "dbt docs generate", "skip_nodes_if_on_run_start_fails": false, "print": true, "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "empty_catalog": false, "static_parser": true, "send_anonymous_usage_stats": true, "validate_macro_args": false, "require_ref_searches_node_package_before_root": false, "printer_width": 80, "require_resource_names_without_spaces": true, "require_all_warnings_handled_by_warn_error": false, "quiet": false, "indirect_selection": "eager", "log_path": "C:\\Users\\azigw\\Documents\\GitHub\\ae_stanley_igwe _monzo\\stanley_igwe_ae_monzo\\logs", "partial_parse": true, "use_colors_file": true, "use_fast_test_edges": false, "which": "generate", "require_generic_test_arguments_property": true, "require_batched_execution_for_custom_microbatch_strategy": false, "vars": {}, "require_nested_cumulative_type_params": false, "state_modified_compare_more_unrendered_values": false, "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "project_dir": "C:\\Users\\azigw\\Documents\\GitHub\\ae_stanley_igwe _monzo\\stanley_igwe_ae_monzo", "select": [], "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_file_max_bytes": 10485760, "state_modified_compare_vars": false, "strict_mode": false, "defer": false, "show_resource_report": false, "upload_to_artifacts_ingest_api": false, "compile": true, "populate_cache": true, "log_level": "info", "log_format_file": "debug", "show_all_deprecations": false, "use_colors": true, "log_format": "default", "profiles_dir": "C:\\Users\\azigw\\.dbt", "static": false, "partial_parse_file_diff": true, "exclude": [], "macro_debugging": false, "version_check": true, "log_level_file": "debug", "source_freshness_run_project_hooks": true}}